{% extends "base.html" %}
{% block title %}Book A Tour Guide - Nasaf Tour Ghana{% endblock %}
{% load static %}

{% block content %}

<!-- Intro Section -->
<section class="py-12 px-4 sm:px-6 lg:px-8" aria-label="Tour Booking Introduction">
    <div class="max-w-7xl mx-auto text-center">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">
            Book A Tour â€“ Your Gateway to Ghana
        </h2>
        <p class="text-base md:text-lg text-gray-700 mb-10">
            Nasafo is your trusted partner for exploring the rich culture, stunning landscapes, and vibrant cities of
            Ghana.
            From the bustling markets of Accra to the serene beaches of Cape Coast, we offer personalized travel
            experiences.
        </p>
    </div>
</section>

<!-- Booking Form Section -->
<section class="bg-gray-50 py-10 px-4 sm:px-6 lg:px-8" aria-label="Tour Booking Form">
    <div class="max-w-5xl mx-auto space-y-12">
        <div class="bg-white p-6 sm:p-8 rounded-lg shadow-md">
            {% if messages %}
                {% for message in messages %}
                <div class="mb-6 p-4 {% if message.tags == 'error' %}bg-red-100 text-red-700{% else %}bg-green-100 text-green-700{% endif %} rounded">
                    {{ message }}
                </div>
                {% endfor %}
            {% endif %}

            <h3 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Basic Information</h3>
            <form method="POST" action="{% url 'booking' %}">
                {% csrf_token %}

                <!-- Personal Info -->
                <div class="mb-4">
                    <label for="{{ form.full_name.id_for_label }}" class="block text-sm font-medium text-gray-700">Full Name *</label>
                    {{ form.full_name }}
                    {% if form.full_name.errors %}
                        <div class="mt-1 text-sm text-red-600">{{ form.full_name.errors }}</div>
                    {% endif %}
                </div>

                <!-- Contact Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700">Email *</label>
                        {{ form.email }}
                        {% if form.email.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.email.errors }}</div>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-gray-700">Phone Number</label>
                        {{ form.phone }}
                        {% if form.phone.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.phone.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Tour Details -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="{{ form.tour_date.id_for_label }}" class="block text-sm font-medium text-gray-700">Tour Date *</label>
                        {{ form.tour_date }}
                        {% if form.tour_date.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.tour_date.errors }}</div>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.start_time.id_for_label }}" class="block text-sm font-medium text-gray-700">Start Time *</label>
                        {{ form.start_time }}
                        {% if form.start_time.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.start_time.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Group Details -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="{{ form.number_of_travelers.id_for_label }}" class="block text-sm font-medium text-gray-700">Number of Travelers *</label>
                        {{ form.number_of_travelers }}
                        {% if form.number_of_travelers.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.number_of_travelers.errors }}</div>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.duration_hours.id_for_label }}" class="block text-sm font-medium text-gray-700">Duration (hours) *</label>
                        {{ form.duration_hours }}
                        {% if form.duration_hours.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.duration_hours.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Interests Section -->
                <div class="mb-12">
                    <h2 id="interests-heading" class="text-2xl md:text-3xl font-bold text-gray-900 text-center mb-8">
                        Your Interests
                    </h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {% for category, interests in interests_by_category.items %}
                            <fieldset class="p-4 border border-gray-200 rounded-lg shadow-sm space-y-4" aria-labelledby="{{ category|slugify }}-legend">
                                <legend id="{{ category|slugify }}-legend" class="text-lg font-semibold text-gray-700 mb-2">
                                    {{ category }}
                                </legend>

                                {% for interest in interests %}
                                    <div class="flex items-start">
                                        <input type="checkbox" name="interests" value="{{ interest.id }}"
                                            id="interest-{{ interest.id }}"
                                            class=" h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring focus:ring-blue-300"
                                            {% if interest.id in form.interests.value %}checked{% endif %}
                                            aria-label="Interest: {{ interest.name }}">
                                        <label for="interest-{{ interest.id }}" class="ml-3 block text-gray-800 text-sm gap-x-4">
                                            {{ interest.name }}
                                        </label>
                                    </div>
                                {% endfor %}
                            </fieldset>
                        {% endfor %}
                    </div>
                </div>

                <!-- One Extra Bag Section -->
                <!-- <div class="mt-12 bg-blue-50 rounded-lg p-6 sm:p-8 border border-blue-200">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">One Extra Bag</h3>
                    <p class="text-gray-700 mb-6">
                        Interested in Giving Back? While these are not traditional tourist sites, if you'd like to visit a local
                        school, clinic, or community organization to present a gift, our One Extra Bag program can help
                        facilitate
                        the experience. For many travelers, this meaningful interaction becomes a highlight of their
                        journey.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {% for option in form.extra_bag_options.field.queryset %}
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <label class="flex items-start gap-3">
                                    <input type="checkbox" name="extra_bag_options" value="{{ option.id }}"
                                        class="mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" 
                                        {% if option.id in form.extra_bag_options.value %}checked{% endif %}>
                                    <div>
                                        <h4 class="font-semibold text-lg text-gray-800">{{ option.name }}</h4>
                                        <p class="text-gray-600 text-sm mt-1">
                                            <span class="font-medium">Needs:</span> {{ option.needs }}
                                        </p>
                                    </div>
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div> -->

                <!-- Anything Else Section -->
                <div class="mt-12 bg-gray-50 rounded-lg p-6 sm:p-8 border border-gray-200">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Anything else?</h3>
                    <p class="text-gray-700 mb-6">
                        Enter additional information below. The more we know, the better we can meet your wishes!
                    </p>

                    <div class="space-y-6">
                        <!-- How did you hear about us -->
                        <div>
                            <h4 class="text-lg font-medium text-gray-800 mb-3">How did you hear about Nasaf Tour Ghana?</h4>
                            {{ form.how_did_you_hear }}
                            {% if form.how_did_you_hear.errors %}
                                <div class="mt-1 text-sm text-red-600">{{ form.how_did_you_hear.errors }}</div>
                            {% endif %}
                        </div>

                        <!-- Mailing list checkbox -->
                        <div class="flex items-start gap-3">
                            {{ form.join_mailing_list }}
                            <label for="{{ form.join_mailing_list.id_for_label }}" class="text-sm font-medium text-gray-700 pl-8">
                                Join our mailing list. We email twice yearly. We do not distribute or sell any email
                                address.
                            </label>
                        </div>
                        {% if form.join_mailing_list.errors %}
                            <div class="mt-1 text-sm text-red-600">{{ form.join_mailing_list.errors }}</div>
                        {% endif %}

                        <!-- reCAPTCHA placeholder -->
                        <div class="flex items-start gap-3">
                            <input id="not_robot" name="not_robot" type="checkbox" required
                                class="mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <div>
                                <label for="not_robot" class="text-sm font-medium text-gray-700">
                                    I'm not a robot
                                </label>
                                <p class="text-xs text-gray-500 mt-1">
                                    reCAPTCHA<br>
                                    Privacy - Terms
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="text-center mt-8">
                    <button type="submit"
                        class="inline-block bg-brand text-white px-6 py-3 rounded-md text-base font-semibold shadow hover:bg-blue-700 transition duration-300">
                        Confirm Booking
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

{% endblock %}